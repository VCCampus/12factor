# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Development Commands

### Core Development
- `cd vue && npm run dev` - Start development server at http://localhost:5173
- `cd vue && npm run build` - Build production bundle to /dist
- `./scripts/build.sh` - Full TOML→JSON→Vue build pipeline
- `cd vue && npm run lint` - Run ESLint for code quality checks
- `cd vue && npm run type-check` - TypeScript compilation check

### TypeScript and Linting
The project uses TypeScript with strict mode enabled. Run `npm run lint` after making changes to ensure code quality.

### Environment Variables

Create a `.env.local` file in the project root with the following variables:


## Project State & Directory Structure


### Main Dependencies

#### Vue Project (Primary)
- **Framework**: Vue 3.4.0, Vue Router 4.2.5
- **Build Tool**: Vite 5.0.10
- **State Management**: Pinia 2.1.7
- **Styling**: Tailwind CSS 3.4.0, Neobrutalism design system
- **TypeScript**: 5.3.0 with strict mode
- **Testing**: Playwright 1.55.0 with E2E automation
- **PDF Export**: jsPDF 3.0.2
- **Build Output**: /dist directory (via Vite build)


### Project Directory Structure
```
/opt/src/12factor/
├── vue/                   # PRIMARY DEVELOPMENT - CSS Digital Entrepreneurship
│   ├── src/              # Vue source code
│   │   ├── components/   # Vue components
│   │   ├── router/       # Vue Router configuration
│   │   ├── stores/       # Pinia state stores
│   │   ├── views/        # Page components
│   │   └── utils/        # Utility functions
│   ├── public/           # Static assets and JSON data
│   │   └── w3sc8_*.json  # Generated JSON from TOML
│   ├── tests/            # Playwright e2e tests
│   └── package.json      # Vue project config
├── dist/                  # Production build output (from Vue)
├── docs/                  # Documentation and planning
│   ├── plans/            # Task analysis and planning
│   │   └── web3scv8_v4.toml # Main TOML configuration
│   ├── reports/          # Research reports and deliverables
│   └── research/         # External reference materials
├── scripts/              # Build and utility scripts (cleaned)
│   ├── build.sh          # Main build script
│   ├── toml-to-json.js   # TOML to JSON converter
│   ├── validate-config.js # TOML validator
│   └── generate-changelog.js # Change tracker
├── logs/                 # Build and test logs

```

## Development Guidelines & Rules

### Project Architecture Decision (2025-08-28)

#### Core Decisions
1. **All new features belong to Vue project** - The Vue application at `/vue` is the primary development platform
2. **Projects remain isolated** - Vue and Next.js projects maintain complete independence  
3. **Vue is the sole development entry point** - All future development uses `/vue` as the source code base

#### Build Output Strategy
- **Vue project**: Builds to `/dist` directory (primary website output)
- **Next.js project**: Builds to `/public` (legacy, not triggered in normal builds)
- **Build script**: `./scripts/build.sh` handles Vue project build and deployment to `/dist`

### Script and Documentation Output Rules

#### 1. Script Output Location
All utility, testing, data processing, and temporary scripts must be output to:
```
/opt/src/12factor/scripts/
```
- Test scripts
- Build helpers
- Data migration tools
- Temporary automation scripts
- Maintenance utilities

#### 2. Documentation Output Locations
All planning, research, and discussion documents must be organized in:
```
/opt/src/12factor/docs/
├── plans/       # Task analysis and implementation plans
├── reports/     # Research outcomes, deliverables, findings
└── research/    # External references and gathered materials
```

#### 3. Directory Conventions
- `/vue` - **Primary source code entry point** (all new development happens here)
- `/dist` - **Vue build output** (website deployment, auto-generated by build.sh)
- `/docs` - Documentation (managed)
- `/scripts` - Utility scripts (managed)
- `/logs` - Development and test logs
- `/src` - Legacy Next.js source (read-only, do not modify)
- All other existing project directories are considered legacy/protected

**Important**: If modifications to protected directories are necessary, always:
1. Request explicit permission first
2. Create new files rather than modifying existing ones
3. Document the reason for changes

### Code Modification Guidelines
1. **Prefer editing over creating**: Always edit existing files rather than creating new ones
2. **No unsolicited documentation**: Never create *.md or README files unless explicitly requested
3. **Respect existing patterns**: Follow the codebase's established conventions
4. **Bilingual support required**: All user-facing content must support both English and Chinese
5. **Dark mode compliance**: All UI components must support dark mode with Tailwind's `dark:` prefix

### Git Workflow
- Main branch: `main`
- Keep commits focused and atomic
- Never commit without explicit user request
- Run `npm run lint` before committing code changes

### Testing Requirements
- Run `cd vue && npm run lint` after code changes
- Verify TypeScript compilation with `cd vue && npm run type-check`
- Test with `cd vue && npm run build` to ensure production readiness
- Run E2E tests with Playwright: baseURL configured for http://web3mh.101.so:11181/
- Test Chinese locale support (primary language)
- Verify neobrutalism design system consistency

## Current Project Status (2025-09-06) - Growth系列页面导航统一完成

### 🎉 最新重大更新 (Issue #26 & #27)
**Growth系列页面导航统一已完成** - 基于Issue #24的移动优先重构成果，进一步解决了导航缺失问题，实现了完整的用户体验统一。

#### 导航统一架构突破
```
AppLayout集成：AppHeader + Growth组件 + AppFooter
混合渲染策略：HTML桥接层 + uniapp语法内核
兼容性方案：UniView/UniText全局组件 + 运行时判断
样式系统：growth-neo-* 命名空间 + neobrutalism统一
```

#### 完整成果总结  
**Issue #24 - 移动优先重构**:
- **✅ Growth*组件架构**: uniapp兼容的移动优先组件系统
- **✅ 智能学习系统**: 闪卡随机算法 + 多模式测试
- **✅ 数据持久化**: growthStore + localStorage会话管理

**Issue #26/#27 - 导航统一**:
- **✅ AppLayout完整集成**: 顶部导航栏 + 底部信息栏全覆盖
- **✅ uniapp兼容架构**: 100%语法保留 + Web环境自动降级
- **✅ Neobrutalism风格**: growth-neo-*统一设计语言
- **✅ 用户体验一致性**: 三个Growth页面导航体验统一

### Active Features
- **Home Dashboard**: CSS数创班8期核心知识体系学习平台
- **个人成长12原则系统**: 完整移动优先学习平台
  - 📚 **GrowthPrinciplesView**: 原则概览，学习阶段，进度统计
  - 🎯 **GrowthFlashcardsView**: 智能闪卡练习 (12/120随机算法)
  - 🏆 **GrowthQuizView**: 多模式测试系统 (练习/考试/复习)
- **Mock Interviews**: 4-difficulty interview system (basic/intermediate/advanced/expert)
- **Thermometer View**: Market sentiment navigation component

### Technical Architecture
- **Data Pipeline**: 个人成长TOML → JSON转换 → growthStore → Growth组件
- **State Management**: growthStore (Pinia) + 原有stores (config, quiz, interview, progress)
- **Routing**: 直接路由映射 (/principles → GrowthPrinciplesView) + AppLayout集成
- **Component System**: 混合渲染架构 (AppLayout + Growth*组件 + uniapp兼容层)
- **Styling**: Tailwind CSS + growth-neo-* neobrutalism设计系统
- **Build Process**: scripts/build.sh全自动化构建流水线 + TypeScript严格模式
- **Data Storage**: localStorage个人成长数据持久化 + PWA离线支持
- **Compatibility**: UniView/UniText全局组件 + 运行时Web降级

### Directory Structure Updates
```
/opt/src/12factor/
├── vue/                           # PRIMARY DEVELOPMENT
│   ├── src/
│   │   ├── components/
│   │   │   ├── growth/            # 🆕 移动优先个人成长组件
│   │   │   │   ├── common/        # GrowthHero.vue, StageCard.vue
│   │   │   │   └── flashcards/    # FlashcardRandomizer.vue
│   │   │   ├── uniapp/            # 🆕 uniapp兼容组件
│   │   │   │   ├── UniView.vue    # view标签Web兼容
│   │   │   │   └── UniText.vue    # text标签Web兼容
│   │   │   └── layout/            # AppLayout布局组件
│   │   ├── stores/
│   │   │   └── growthStore.ts     # 🆕 个人成长集中状态管理
│   │   └── views/
│   │       ├── Growth*.vue        # 🆕 AppLayout集成的Growth页面
│   │       └── (其他原有页面)
│   ├── public/
│   │   ├── growth-principles-*.json # 🆕 个人成长数据文件
│   │   └── (其他静态资源)
├── disused/                       # 归档旧组件和页面
│   ├── components/principles/     # 旧Principles组件
│   ├── stores/quiz.ts            # 旧quiz状态管理
│   └── views/PrinciplesView.vue  # 旧Principles页面
├── scripts/
│   ├── growth-principles-converter.js # 🆕 TOML转JSON转换器
│   └── test-navigation.js        # 🆕 导航集成测试脚本
├── docs/
│   ├── reports/
│   │   └── 250906_growth_principles_mobile_refactor.md # 🆕 重构详细报告
└── dist/                          # 生产构建输出 (1.6M)
```

### Current Code Quality Status
- ✅ **Build**: 成功编译到 /dist (~1.6M, gzip优化)
- ✅ **TypeScript**: 类型检查通过，新增uniapp兼容组件类型定义
- ✅ **ESLint**: 代码质量检查通过，架构清晰无冲突
- ✅ **Architecture**: AppLayout + Growth组件混合架构，职责分离清晰
- ✅ **Deployment**: 生产环境部署验证通过 (http://web3mh.101.so:11181/)
- ✅ **UX Consistency**: 三个Growth页面导航体验完全统一
- ✅ **Compatibility**: 100% uniapp语法保留 + Web环境完美降级

### Next Phase Priorities
1. **E2E测试更新** (高优先级): 更新Playwright测试用例匹配新AppLayout架构
2. **性能监控** (高优先级): 监控混合渲染性能，优化bundle size
3. **设计系统标准化** (中优先级): 将growth-neo-*样式抽取为通用设计系统  
4. **组件文档完善** (中优先级): 为uniapp兼容组件添加使用文档
5. **学习分析功能** (低优先级): 学习时长统计，知识掌握度可视化

### Data Sources
- **个人成长数据**: docs/plans/250906-growth_principles_*.toml (转换脚本: scripts/growth-principles-converter.js)
- **生成JSON文件**: vue/public/growth-principles-*.json (180.88 KB总计)
- **CSS数创配置**: docs/plans/web3scv8_v4.toml (4.0.0) → vue/public/w3sc8_*.json 
- **面试题库**: vue/public/data/interview-*.json (9个难度文件)
- **Git记录**: Issue #26/#27 导航统一完成 (commit: 458fe9a + 后续commits)